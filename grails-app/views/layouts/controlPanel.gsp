<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="es"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="es"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="es"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es"> <!--<![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="es" class="no-js"><!--<![endif]-->
<!--
/* @license
 * MyFonts Webfont Build ID 2300113, 2012-05-29T11:39:53-0400
 *
 * The fonts listed in this notice are subject to the End User License
 * Agreement(s) entered into by the website owner. All other parties are
 * explicitly restricted from using the Licensed Webfonts(s).
 *
 * You may obtain a valid license at the URLs below.
 *
 * Webfont: Fyra Numeric Circle Closed by Jonathan Hughes
 * URL: http://www.myfonts.com/fonts/jonathan-hughes/fyra/numeric-circle-closed/
 * Copyright: Copyright (c) 2009 by Jonathan Hughes. All rights reserved.
 * Licensed pageviews: unlimited
 *
 *
 * License: http://www.myfonts.com/viewlicense?type=web&buildid=2300113
 *
 * © 2012 Bitstream Inc
*/

-->
	<head>
        <link href='http://fonts.googleapis.com/css?family=Terminal+Dosis|Varela' rel='stylesheet' type='text/css'>
	    <link rel="image_src" href="http://nest5.com/images/logo.png" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="${resource(dir: 'images', file: 'favicon.ico')}" type="image/x-icon">
        <link rel="apple-touch-icon" href="${resource(dir: 'images', file: 'apple-touch-icon.png')}">
        <link rel="apple-touch-icon" sizes="114x114" href="${resource(dir: 'images', file: 'apple-touch-icon-retina.png')}">
        <title><g:layoutTitle default="Nest5, Tu cupón de descuentos en las mejores Marcas"/></title>
        <r:require modules="jquerybrowserfix"/>
                <!-- Main Stylesheet -->
        <link rel="stylesheet" type="text/css" href="${resource(dir: 'jquery-ui/css/ui-lightness', file: 'jquery-ui-1.10.3.custom.min.css')}">
        <link rel="stylesheet" href="${resource(dir: 'css', file: 'CardStyle.css')}" type="text/css" />
        <link rel="stylesheet" href="${resource(dir: 'css', file: 'Panelstyle.css')}" type="text/css" />
        <!-- Colour Schemes
        Default colour scheme is blue. Uncomment prefered stylesheet to use it.
        <link rel="stylesheet" href="css/brown.css" type="text/css" media="screen" />
        <link rel="stylesheet" href="css/gray.css" type="text/css" media="screen" />
        <link rel="stylesheet" href="css/green.css" type="text/css" media="screen" />
        <link rel="stylesheet" href="css/pink.css" type="text/css" media="screen" />

        <link rel="stylesheet" href="${resource(dir: 'css', file: 'red.css')}" type="text/css" media="screen" />
         -->
        <!-- Your Custom Stylesheet -->
        <link rel="stylesheet" href="${resource(dir: 'css', file: 'custom.css')}" type="text/css" />
        <link rel="stylesheet" type="text/css" href="${resource(dir: 'css', file: 'MyFontsWebfontsKit.css')}">
        <link rel="stylesheet" type="text/css" href="${resource(dir: 'listy/css', file: 'listy.css')}">
        <link rel="stylesheet" href="${resource(dir: 'bootstrap/css',file: 'bootstrap.min.css')}" type="text/css" />
        <link rel="stylesheet" href="${resource(dir: 'bootstrap/css',file: 'bootstrap_custom.css')}" type="text/css" />
        <link rel="stylesheet" href="${resource(dir: 'modal-extend/css',file: 'bootstrap-modal.css')}" type="text/css" />




        <r:layoutResources />
    <script type="text/javascript" src="${resource(dir: 'jquery-ui/js', file: 'jquery-ui-1.10.3.custom.min.js')}"></script>




        <!--swfobject - needed only if you require <video> tag support for older browsers -->
        <script type="text/javascript" src="${resource(dir: 'js', file: 'swfobject.js')}"></script>
        <!-- jQuery with plugins -->


        <!-- jQuery tooltips -->
        <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.tipTip.min.js')}"></script>
        <!-- Superfish navigation -->

        <!-- jQuery form validation -->
        <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.validate_pack.js')}"></script>
        <!-- jQuery popup box -->
        <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.nyroModal.pack.js')}"></script>
        <!-- jQuery graph plugins -->
        <!--[if IE]><script type="text/javascript" src="${resource(dir: 'js/flot', file: 'excanvas.min.js')}"></script><![endif]-->
        <script type="text/javascript" src="${resource(dir: 'js/flot', file: 'jquery.flot.min.js')}"></script>
        <!-- Internet Explorer Fixes -->
        <!--[if IE]>
        <link rel="stylesheet" type="text/css" media="all" href="${resource(dir: 'css', file: 'ie.css')}"/>
        <script src="${resource(dir: 'js', file: 'html5.js')}"></script>
        <![endif]-->
        <!--Upgrade MSIE5.5-7 to be compatible with MSIE8: http://ie7-js.googlecode.com/svn/version/2.1(beta3)/IE8.js -->
        <!--[if lt IE 8]>
        <script src="${resource(dir: 'js', file: 'IE8.js')}"></script>
        <![endif]-->

    <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.superfish.min.js')}"></script>
    <script type="text/javascript" src="${resource(dir: 'js', file: 'jquery.supersubs.min.js')}"></script>


		%{--<link rel="stylesheet" href="${resource(dir: 'css', file: 'style.css')}" type="text/css">--}%
        %{--<link rel="stylesheet" href="${resource(dir:'css',file:'twitter-auth.css')}" />--}%



        <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <script src="${resource(dir: 'js/libs', file: 'modernizr-2.5.3-respond-1.1.0.min.js')}"></script>
        <!--[if gte IE 9]>
          <style type="text/css">
            .gradient {
               filter: none;
            }
          </style>
        <![endif]-->

            <script src="${resource(dir: 'Chart.js', file: 'Chart.min.js')}"></script>
            <script src="${resource(dir:'feed/js', file: 'spin.min.js')}"></script>

        <g:layoutHead/>
	</head>
	<body>

    <!--[if lt IE 7]><p class=chromeframe>¡Lo Sentimos!, Nest5 aún no es tan maduro como para  soportar tu navegador.</em> <a href="http://browsehappy.com/">Actualízalo</a> o <a href="http://www.google.com/chromeframe/?redirect=true">Instala este complemento que te permitirá vivir La Experiencia,, se toma solo unos segundos y no tienes que salir del sitio.</a></p><![endif]-->
    <!-- Header -->
    <header id="top">
        <div class="wrapper">
            <!-- Title/Logo - can use text instead of image -->
            <div id="title"><img src="https://s3-us-west-2.amazonaws.com/com.nest5.assets/user-profile/letras_nest5_70x70.png" alt="Nest5" height="70" /><!--<span>Administry</span> demo--></div>
            <!-- Top navigation -->
            <div id="topnav">
                <a id="companyAvatar" class="avatar_change" href="#"><img class="avatar" src="${picture}" alt="" style="max-width: 32px; height: auto;" /></a>
                <b>${user.name}</b>
                <span>|</span> <a href="#">Configuración</a>
                <span>|</span> <a href="#">Salir</a><br />
            <g:remoteLink before="loadContent()" title="Escribe un nuevo Mensaje" id="new-message"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'addstore']}"><span  class="edit-icons"><img src="${resource(dir:'images/icons',file:'write_message_blue.png')}" alt=""></span></g:remoteLink>
                <small>Tienes <a href="${createLink(controller:'company',action:'messages')}" class="high"><b>${messages}</b> nuevo(s) mensaje(s)!</a></small>
            </div>
            <!-- End of Top navigation -->
            <!-- Main navigation -->
            <nav id="menu">
                <ul class="sf-menu">
                    %{--<li class="current"><g:remoteLink before="loadContent()" id="menu-panel"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'panel']}">Panel</g:remoteLink></li>--}%
                    <li class="current"><a href="${createLink(uri:'/company/panel')}">Dashboard</a> </li>
                    <li>
                        <g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'stores']}">Locales</g:remoteLink>
                        <ul>
                            <li>
                        <li>
                            <g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'addstore']}">Nueva Tienda</g:remoteLink>

                        </li>

                            </li>
                            <li>
                                <g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'stores']}">Locales</g:remoteLink></a>
                                %{--<ul>
                                    <li><a href="samples-files.html">Files</a></li>
                                    <li><a href="samples-products.html">Products</a></li>
                                </ul>--}%
                            </li>

                        </ul>
                    </li>
                    <li><g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'promos']}">Promociones</g:remoteLink>
                        <ul>
                            <li>
                                <g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'addpromo']}">Nueva Promoción</g:remoteLink>

                            </li>
                            <li>
                                <g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'promos']}">Vitrina</g:remoteLink>
                                %{--<ul>
                                    <li><a href="samples-files.html">Files</a></li>
                                    <li><a href="samples-products.html">Products</a></li>
                                </ul>--}%
                            </li>
                        </ul>
                    </li>
                    <li>
                        %{--<g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'users']}">Usuarios</g:remoteLink></a>--}%
                        <a href="${createLink(uri:'/company/demographics')}">Usuarios</a>
                        %{--<ul>
                            <li><a href="samples-files.html">Files</a></li>
                            <li><a href="samples-products.html">Products</a></li>
                        </ul>--}%
                    </li>

            <li>
                %{--<g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'stats']}">Estadísticas</g:remoteLink></a>--}%
                <a href="${createLink(uri: '/company/interactions')}">Interacciones</a>
                %{--<ul>
                    <li><a href="samples-files.html">Files</a></li>
                    <li><a href="samples-products.html">Products</a></li>
                </ul>--}%
            </li>
            <li>
                %{--<g:remoteLink before="loadContent()" id="menu-stores"  onSuccess="setContent(data)" controller="company"  action="panel" params= "${[activity: 'users']}">Usuarios</g:remoteLink></a>--}%
                <a href="${createLink(uri:'/company/complementary')}">Complementarias</a>
                %{--<ul>
                    <li><a href="samples-files.html">Files</a></li>
                    <li><a href="samples-products.html">Products</a></li>
                </ul>--}%
            </li>

                </ul>
            </nav>
            <!-- End of Main navigation -->
            <!-- Aside links -->
            <aside><b>Español</b> &middot; <a href="#">English</a> &middot; <a href="#">Deutsch</a></aside>
            <!-- End of Aside links -->
        </div>
    </header>
    <!-- End of Header -->
		<g:layoutBody/>
    <!-- Page footer -->
    <footer id="bottom">
        <div class="wrapper">
            <nav>
                <a href="#">Panel</a> &middot;
                <a href="#">Noticias</a> &middot;
                <a href="#">Blog</a> &middot;
                <a href="#">Usuarios</a> &middot;
                <a href="#">Prensa</a> &middot;
                <a href="#">Eventos</a> &middot;
                <a href="#">Organización</a> &middot;
                <a href="#">Configuración</a>
            </nav>
            <p>Copyright &copy; 2012 <b><a href="http://nest5.com" title="Beneficios en tu telefono móvil">Nest5</a></b></p>
        </div>
    </footer>
    <!-- End of Page footer -->

    <!-- Animated footer -->
    <footer id="animated">
        <ul>
            <li><a href="#">Panel</a></li>
            <li><a href="#">Noticias</a></li>
            <li><a href="#">Blog</a></li>
            <li><a href="#">Usuarios</a></li>
            <li><a href="#">Prensa</a></li>
            <li><a href="#">Eventos</a></li>
            <li><a href="#">Organización</a></li>
            <li><a href="#">Configuración</a></li>
        </ul>
    </footer>
    <!-- End of Animated footer -->

    <!-- Scroll to top link -->
    <a href="#" id="totop">^ Ir Arriba</a>
    %{--File Upload


    --}%

    <form name="file_upload_form" id="file_upload_form" action="#" enctype="multipart/form-data" style="position: absolute; top: -500px; left: -500px;">
        <input type="file" id="fileselect" name="fileselect[]" />
        <input type="hidden" name="company" value="${user?.id}" />
        <input type="hidden" name="position" value="" id="positionField" />

    </form>
    <!-- Admin template javascript load -->
    <script type="text/javascript" src="${resource(dir: 'js',file: 'administry.js' )}"></script>

		<g:javascript library="application"/>
        <g:javascript library="plugins"/>
        <g:javascript library="script"  />

         <script>
            /*
             var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
             (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
             g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
             s.parentNode.insertBefore(g,s)}(document,'script'));
             */
        </script>

    <r:script>
var loading1;
function loadContent(){

    var html = "<img src='${resource(dir: 'images',file: 'preloader.gif')}' alt='Loading Content' />";
    $("#pageBody").html(html);
}

function setContent(data){
$("#pageBody").html(data);
}

        $(document).ready(function(){
            $("#new-message").tipTip({position: "bottom"});
            $("body").on('click',".avatar_change",function(e){
                  e.preventDefault();
                 $("#fileselect").click();
             });
            $("#fileselect").change(function(){
//            console.log("aca");
                    var opts = {
                lines: 9, // The number of lines to draw
                length: 0, // The length of each line
                width: 8, // The line thickness
                radius: 4, // The radius of the inner circle
                corners: 1, // Corner roundness (0..1)
                rotate: 90, // The rotation offset
                direction: 1, // 1: clockwise, -1: counterclockwise
                color: '#000', // #rgb or #rrggbb
                speed: 1.6, // Rounds per second
                trail: 45, // Afterglow percentage
                shadow: true, // Whether to render a shadow
                hwaccel: true, // Whether to use hardware acceleration
                className: 'spinner', // The CSS class to assign to the spinner
                zIndex: 2e9, // The z-index (defaults to 2000000000)
                top: 'auto', // Top position relative to parent in px
                left: 'auto' // Left position relative to parent in px
            };

            var target = $("#companyAvatar");
            var spinner1 = new Spinner(opts).spin();
//            $(spinner1.el).css("marginLeft", "50%");
            target.html(spinner1.el);
            loading1 = spinner1;
                uploadFile();
              });
        });


        // file selection
       function uploadFile()
       {
           var formData = new FormData($('#file_upload_form')[0]);
           $.ajax({
               url: '${createLink(controller: 'imageuploader', action: 'companyUploadMain')}', //server script to process data
               type: 'POST',
               xhr: function() {  // custom xhr
                   myXhr = $.ajaxSettings.xhr();
                   if(myXhr.upload){ // check if upload property exists
                       // for handling the progress of the upload
                       myXhr.upload.addEventListener('progress',progressHandlingFunction, false);
                   }
                   return myXhr;
               },
               success: function(result)
               {
                console.log(result);
                   //console.log($.ajaxSettings.xhr().upload);
                   //alert(result);
                   if(result.success)
                   {
                     $("#companyAvatar").html('<img src="'+result.ruta+'" style="max-width: 32px; height: auto;"/>');
                    //alert("Subida con éxito");
                   }


               },
               // Form data
               data: formData,
               //Options to tell JQuery not to process data or worry about content-type
               cache: false,
               contentType: false,
               processData: false
           });


       }
        function progressHandlingFunction(e){
            if(e.lengthComputable){
//            console.log("Porcentaje: "+e.loaded+"/"+e.total);
//                $("#progress").text(e.loaded + " / " e.total);
            var perc = (e.loaded / e.total) * 100;
            }
        }


    </r:script>
    <r:layoutResources />

    <script src="${resource(dir: 'bootstrap/js', file: 'bootstrap.min.js')}"></script>
    <script src="${resource(dir: 'modal-extend/js', file: 'bootstrap-modalmanager.js')}"></script>
    <script src="${resource(dir: 'modal-extend/js', file: 'bootstrap-modal.js')}"></script>
    <script type="text/javascript" src="${resource(dir: 'listy/js', file: 'jquery.listy.js')}"></script>
	</body>
</html>